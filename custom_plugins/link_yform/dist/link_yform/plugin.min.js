(()=>{var E=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(n,r)=>(typeof require!="undefined"?require:n)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var y=E("@ephox/katamari"),w=(e,n,r)=>{let s;return r(e,n.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===n.name},j=e=>{let n=typeof e;return e===null?"null":n==="object"&&Array.isArray(e)?"array":n==="object"&&w(e,String,(r,s)=>Object.prototype.isPrototypeOf.call(s,r))?"string":n},d=e=>n=>j(n)===e,m=e=>e==null,M=d("object"),k=d("string"),T=e=>{e.options.register("link_yform_tables",{processor:"object",default:{title:"YForm",items:[]}});let n=e.options.get("link_yform_tables"),r=n.title,s=n.items,u=[];for(let t=0,l=s.length;t<l;++t){let o=s[t],i=[];if(M(o)||i.push("Entry is not an object."),m(o.table)&&i.push('Key "table" with table name as value is missing.'),m(o.field)&&i.push('Key "field" with field name as value is missing.'),i.length>0){console.warn("TinyMCE Plugin link-yform reports for entry "+(t+1)+`: 
- `+i.join(`
- `));continue}let c=m(o.title)?o.table:o.title;u.push({type:"menuitem",text:c,onAction:()=>h(o)})}let _=t=>y.Type.isNonNullable(t)&&t.nodeName==="FIGURE"&&/\bimage\b/i.test(t.className),b=(t,l,o)=>{var c;let i=t.select("img",l)[0];if(i){let a=t.create("a",o);(c=i.parentNode)==null||c.insertBefore(a,i),a.appendChild(i)}},h=t=>{try{let l=e.dom,o=newPoolWindow("index.php?page=yform/manager/data_edit&table_name="+t.table+"&rex_yform_manager_opener[id]=1&rex_yform_manager_opener[field]="+t.field+"&rex_yform_manager_opener[multiple]=0");$(o).on("rex:YForm_selectData",function(i,c,a){i.preventDefault(),o.close(),a=a.replace(new RegExp("(.*?)\\s\\[.*?\\]","gi"),"$1");let f={href:(!m(t.url)&&k(t.url)?t.url:t.table.split("_").join("-")+"://")+c,title:a},p=e.selection.getNode();if(_(p))b(l,p,f);else{let g=l.encode(a);e.selection.getContent()&&(g=e.selection.getContent()),e.insertContent(l.createHTML("a",f,g))}})}catch(l){console.log(l)}};e.ui.registry.addMenuButton("link_yform",{text:r,fetch:t=>{t(u)}})},C=()=>{tinymce.PluginManager.add("link_yform",T)};})();
