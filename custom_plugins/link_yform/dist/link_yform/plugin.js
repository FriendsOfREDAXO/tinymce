!function(){"use strict";const u=e=>{return!(null==e)};function e(n){return function(e){return t=typeof(e=e),(null===e?"null":"object"==t&&Array.isArray(e)?"array":"object"==t&&r(e,String,function(e,t){return Object.prototype.isPrototypeOf.call(t,e)})?"string":t)===n;var t}}var r=function(e,t,n){return!!n(e,t.prototype)||(null==(n=e.constructor)?void 0:n.name)===t.name},c=function(e){return null==e},a=e("object"),f=e("string");tinymce.PluginManager.add("link_yform",function(s){s.options.register("link_yform_tables",{processor:"object",default:{title:"YForm",items:[]}});for(var e=s.options.get("link_yform_tables"),t=e.title,r=e.items,o=[],n=0,i=r.length;n<i;++n)!function(e){var t=r[e],n=[];if(a(t)||n.push("Entry is not an object."),c(t.table)&&n.push('Key "table" with table name as value is missing.'),c(t.field)&&n.push('Key "field" with field name as value is missing.'),0<n.length)return console.warn("TinyMCE Plugin link-yform reports for entry "+(e+1)+": \n- "+n.join("\n- "));e=c(t.title)?t.table:t.title;o.push({type:"menuitem",text:e,onAction:function(){return l(t)}})}(n);var l=function(i){try{var l=s.dom,a=newPoolWindow("index.php?page=yform/manager/data_edit&table_name="+i.table+"&rex_yform_manager_opener[id]=1&rex_yform_manager_opener[field]="+i.field+"&rex_yform_manager_opener[multiple]=0");$(a).on("rex:YForm_selectData",function(e,t,n){e.preventDefault(),a.close();var r,o,e={href:(!c(i.url)&&f(i.url)?i.url:i.table.split("_").join("-")+"://")+t,title:n},t=s.selection.getNode();o=t,u(o)&&"FIGURE"===o.nodeName&&/\bimage\b/i.test(o.className)?(o=t,t=e,(o=(r=l).select("img",o)[0])&&(r=r.create("a",t),null!=(t=o.parentNode)&&t.insertBefore(r,o),r.appendChild(o))):(n=s.selection.getContent()?s.selection.getContent():n.replace(new RegExp("(.*?)\\s\\[.*?\\]","gi"),"$1"),s.insertContent(l.createHTML("a",e,l.encode(n))))})}catch(e){console.log(e)}};s.ui.registry.addMenuButton("link_yform",{text:t,fetch:function(e){e(o)}})})}();