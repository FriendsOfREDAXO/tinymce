(()=>{var h=(e,i,c)=>{let l;return c(e,i.prototype)?!0:((l=e.constructor)===null||l===void 0?void 0:l.name)===i.name},E=e=>{let i=typeof e;return e===null?"null":i==="object"&&Array.isArray(e)?"array":i==="object"&&h(e,String,(c,l)=>Object.prototype.isPrototypeOf.call(l,c))?"string":i},d=e=>i=>E(i)===e,u=e=>e==null,w=d("object"),j=d("string"),M=e=>{e.options.register("link_yform_tables",{processor:"object",default:{title:"YForm",items:[]}});let i=e.options.get("link_yform_tables"),c=i.title,l=i.items,f=[];for(let t=0,s=l.length;t<s;++t){let n=l[t],o=[];if(w(n)||o.push("Entry is not an object."),u(n.table)&&o.push('Key "table" with table name as value is missing.'),u(n.field)&&o.push('Key "field" with field name as value is missing.'),o.length>0){console.warn("TinyMCE Plugin link-yform reports for entry "+(t+1)+`: 
- `+o.join(`
- `));continue}let a=u(n.title)?n.table:n.title;f.push({type:"menuitem",text:a,onAction:()=>b(n)})}let y=t=>t!=null&&t.nodeName==="FIGURE"&&/\bimage\b/i.test(t.className),_=(t,s,n)=>{var a;let o=t.select("img",s)[0];if(o){let r=t.create("a",n);(a=o.parentNode)==null||a.insertBefore(r,o),r.appendChild(o)}},b=t=>{try{let s=e.dom,n=newPoolWindow("index.php?page=yform/manager/data_edit&table_name="+t.table+"&rex_yform_manager_opener[id]=1&rex_yform_manager_opener[field]="+t.field+"&rex_yform_manager_opener[multiple]=0");$(n).on("rex:YForm_selectData",function(o,a,r){o.preventDefault(),n.close(),r=r.replace(new RegExp("(.*?)\\s\\[.*?\\]","gi"),"$1");let m={href:(!u(t.url)&&j(t.url)?t.url:t.table.split("_").join("-")+"://")+a,title:r},g=e.selection.getNode();if(y(g))_(s,g,m);else{let p=s.encode(r);e.selection.getContent()&&(p=e.selection.getContent()),e.insertContent(s.createHTML("a",m,p))}})}catch(s){console.log(s)}};e.ui.registry.addMenuButton("link_yform",{text:c,fetch:t=>{t(f)}})},k=()=>{tinymce.PluginManager.add("link_yform",M)};})();
